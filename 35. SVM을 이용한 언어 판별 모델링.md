# ğŸ“˜ 35ì¼ì°¨ TIL: SVMì„ ì´ìš©í•œ ì–¸ì–´ íŒë³„ ëª¨ë¸ë§
---

### 1. ì–¸ì–´ íŒë³„ ëª¨ë¸ ì‹¤ìŠµ ì½”ë“œ ìƒì„¸ ë¶„ì„

```python
from sklearn import svm, metrics
import glob, os.path, re, json

# [Step 1] íŒŒì¼ ì½ê¸° ë° ì•ŒíŒŒë²³ ì¶œí˜„ ë¹ˆë„ ì¡°ì‚¬ í•¨ìˆ˜
def check_freq(fname):
    # íŒŒì¼ ê²½ë¡œì—ì„œ íŒŒì¼ëª…ë§Œ ì¶”ì¶œ (ì˜ˆ: "en-1.txt" -> "en")
    name = os.path.basename(fname)
    # ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ íŒŒì¼ëª…ì˜ ì•ë¶€ë¶„ ì–¸ì–´ ì½”ë“œ(en, fr ë“±) ì¶”ì¶œ
    lang = re.match(r'^[a-z]{2,}', name).group()
    
    with open(fname, "r", encoding="utf-8") as f:
        text = f.read()
        text = text.lower() # ëŒ€ì†Œë¬¸ì êµ¬ë¶„ì„ ì—†ì• ê¸° ìœ„í•´ ì†Œë¬¸ìë¡œ í†µì¼

    # ì•ŒíŒŒë²³ 26ê°œë¥¼ ë‹´ì„ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™” [0, 0, ..., 0] (Index 0=a, 25=z)
    cnt = [0 for n in range(0, 26)]
    code_a = ord("a") # 'a'ì˜ ì•„ìŠ¤í‚¤ ì½”ë“œê°’ (97)
    code_z = ord("z") # 'z'ì˜ ì•„ìŠ¤í‚¤ ì½”ë“œê°’ (122)

    # í…ìŠ¤íŠ¸ì˜ ê° ë¬¸ìë¥¼ í™•ì¸í•˜ì—¬ ì•ŒíŒŒë²³ ë¹ˆë„ìˆ˜ ê³„ì‚°
    for ch in text:
        n = ord(ch)
        if code_a <= n <= code_z: # ë¬¸ì nì´ a~z ì‚¬ì´ì˜ ì•ŒíŒŒë²³ì¸ ê²½ìš°ì—ë§Œ
            cnt[n - code_a] += 1  # í•´ë‹¹ ì•ŒíŒŒë²³ì˜ ì¸ë±ìŠ¤ ê°’ì„ 1 ì¦ê°€

    # [ì¤‘ìš”] ì •ê·œí™”(Normalization): ë‹¨ìˆœ ê°œìˆ˜ê°€ ì•„ë‹Œ ì „ì²´ ëŒ€ë¹„ 'ë¹„ìœ¨'ë¡œ ë³€í™˜
    # ë¬¸ì„œê°€ ê¸¸ë©´ ì•ŒíŒŒë²³ ê°œìˆ˜ê°€ ë§ì•„ì§€ëŠ” í˜„ìƒì„ ë°©ì§€í•˜ê¸° ìœ„í•¨
    total = sum(cnt)
    freq = list(map(lambda n: n / total, cnt))
    
    return (freq, lang) # (ë¹ˆë„ìˆ˜ ë¦¬ìŠ¤íŠ¸, ì •ë‹µ ë ˆì´ë¸”) ë°˜í™˜

# [Step 2] ì§€ì •ëœ ê²½ë¡œì˜ ëª¨ë“  íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
def load_files(path):
    freqs = []
    labels = []
    file_list = glob.glob(path) # í´ë” ë‚´ì˜ ëª¨ë“  .txt íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
    
    for fname in file_list:
        r = check_freq(fname)   # ê° íŒŒì¼ë³„ ë¹ˆë„ìˆ˜ ê³„ì‚°
        freqs.append(r[0])      # Feature ë°ì´í„° (26ì°¨ì› ë²¡í„°)
        labels.append(r[1])     # Target ë°ì´í„° (ì–¸ì–´ ì½”ë“œ)
            
    return {"freqs":freqs, "labels":labels}

# [Step 3] í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¤€ë¹„
# train í´ë” ë°ì´í„°ë¡œ í•™ìŠµìš© ë°ì´í„° ìƒì„±, test í´ë” ë°ì´í„°ë¡œ ê²€ì¦ìš© ë°ì´í„° ìƒì„±
data = load_files("./lang/train/*.txt")
test = load_files("./lang/test/*.txt")

# ì „ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ ë‚˜ì¤‘ì— ë‹¤ì‹œ ì“¸ ìˆ˜ ìˆë„ë¡ JSON í˜•íƒœë¡œ ì €ì¥
with open("./lang/freq.json", "w", encoding="utf-8") as fp:
    json.dump([data, test], fp)

# [Step 4] SVM ëª¨ë¸ ìƒì„± ë° í•™ìŠµ
# SVC: Support Vector Classification (ë¶„ë¥˜ìš© SVM)
clf = svm.SVC()
clf.fit(data["freqs"], data["labels"]) # í•™ìŠµ ë°ì´í„°ì™€ ì •ë‹µ ì „ë‹¬

# [Step 5] ì˜ˆì¸¡í•˜ê¸°
# í•™ìŠµì— ì‚¬ìš©ë˜ì§€ ì•Šì€ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°ì˜ ë¹ˆë„ìˆ˜(freqs)ë¥¼ ë³´ê³  ì–¸ì–´ ì˜ˆì¸¡
predict = clf.predict(test["freqs"])

# [Step 6] ê²°ê³¼ ë¶„ì„
# ì‹¤ì œ ì •ë‹µ(test["labels"])ê³¼ ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’(predict)ì„ ë¹„êµ
ac_score = metrics.accuracy_score(test["labels"], predict)
cl_report = metrics.classification_report(test["labels"], predict)

print("ì •ë‹µë¥  =", ac_score)
print("ë¦¬í¬íŠ¸ =")
print(cl_report)

```

---

### 2. SVM (Support Vector Machine) í•µì‹¬ ì •ë¦¬

#### ğŸ’¡ SVMì´ë€?

ë°ì´í„°ë“¤ì„ ì„œë¡œ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•  ë•Œ, ê·¸ ê²½ê³„ì„ (ê²°ì • ê²½ê³„)ì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ë‹¨ìˆœíˆ ë¶„ë¥˜í•˜ëŠ” ê²ƒì„ ë„˜ì–´ **ë§ˆì§„(Margin, ë°ì´í„°ì™€ ê²½ê³„ì„  ì‚¬ì´ì˜ ê±°ë¦¬)ì„ ìµœëŒ€í™”**í•˜ëŠ” ìµœì ì˜ ì„ ì„ ì°¾ê¸° ë•Œë¬¸ì— "ìµœëŒ€ ë§ˆì§„ ë¶„ë¥˜ê¸°"ë¼ê³ ë„ ë¶ˆë¦½ë‹ˆë‹¤.

#### ğŸ’¡ SVR vs SVC

* **SVC (Classification):** 'ë¶„ë¥˜'ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜¤ëŠ˜ ì‹¤ìŠµì²˜ëŸ¼ í…ìŠ¤íŠ¸ë¥¼ ë³´ê³  'ì˜ì–´'ì¸ì§€ 'í”„ë‘ìŠ¤ì–´'ì¸ì§€ ë‚˜ëˆ„ëŠ” ì‘ì—…ì— ì“°ì…ë‹ˆë‹¤.
* **SVR (Regression):** 'íšŒê·€'ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ì‚°ì ì¸ ì¹´í…Œê³ ë¦¬ê°€ ì•„ë‹Œ ì—°ì†ëœ ìˆ«ì(ì˜ˆ: ë‚´ì¼ì˜ ê¸°ì˜¨, ì§‘ê°’)ë¥¼ ì˜ˆì¸¡í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ğŸ’¡ ì»¤ë„ í•¨ìˆ˜ (Kernel Function)

ë°ì´í„°ê°€ 2ì°¨ì› í‰ë©´ì—ì„œ ì§ì„  í•˜ë‚˜ë¡œ ê¹”ë”í•˜ê²Œ ë‚˜ëˆ„ì–´ì§€ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

* **ì—­í• :** ì €ì°¨ì› ë°ì´í„°ë¥¼ ê³ ì°¨ì›ìœ¼ë¡œ ë³´ë‚´ì„œ(ë¹„ìœ í•˜ìë©´ ì¢…ì´ë¥¼ êµ¬ê²¨ì„œ ì…ì²´ì ìœ¼ë¡œ ë§Œë“¦) ì§ì„ (ì´ˆí‰ë©´)ìœ¼ë¡œ ìë¥¼ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
* **ëŒ€í‘œ ì¢…ë¥˜:** `Linear`(ì„ í˜•), `Polynominal`(ë‹¤í•­ì‹), `RBF`(ê°€ìš°ì‹œì•ˆ ì»¤ë„ - ê°€ì¥ ë§ì´ ì“°ì„).
