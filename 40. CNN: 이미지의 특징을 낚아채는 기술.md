## ğŸ’¡ [40ì¼ì°¨] CNN: ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì„ ë‚šì•„ì±„ëŠ” ê¸°ìˆ 

### 1. í•©ì„±ê³±(Convolution)ê³¼ í•„í„°ì˜ ì›ë¦¬

* **í–‰ë ¬ê³±ê³¼ ë‚´ì :** ì´ë¯¸ì§€ í”½ì…€ ë­‰ì¹˜ì™€ í•„í„°(Filter/Kernel)ë¥¼ ê²¹ì³ì„œ ë‚´ì í•˜ëŠ” í–‰ìœ„ëŠ” **"ì´ í•„í„°ê°€ ê°€ì§„ íŒ¨í„´ì´ ì´ë¯¸ì§€ì˜ ì´ ì˜ì—­ì— ì–¼ë§ˆë‚˜ ì¡´ì¬í•˜ëŠ”ê°€?"**ë¼ëŠ” ìƒê´€ê´€ê³„ë¥¼ ìˆ˜ì¹˜í™”í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
* **í•„í„°ì˜ ì§„í™”:** ì²˜ìŒì—ëŠ” ìˆ˜ì§ì„ , ìˆ˜í‰ì„  ê°™ì€ ë³´í¸ì  íŒ¨í„´ìœ¼ë¡œ ì‹œì‘í•˜ì§€ë§Œ, í•™ìŠµì´ ì§„í–‰ë ìˆ˜ë¡ ëˆˆ, ì½”, ì… ê°™ì€ ì •êµí•œ íŠ¹ì§•ì„ ì°¾ì•„ë‚´ëŠ” í•„í„°ë¡œ ìŠ¤ìŠ¤ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.
* **ì—°ì‚°ì˜ ì˜ë¯¸:** * **ê³±í•˜ê¸°():** í•„í„°ì™€ ì´ë¯¸ì§€ì˜ **ìœ ì‚¬ë„ë¥¼ ì¸¡ì •**í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. (íŒ¨í„´ ì¼ì¹˜ í™•ì¸)
* **ë”í•˜ê¸°():** ìœ ì‚¬ë„ ì¸¡ì • ê²°ê³¼ë“¤ì„ **í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì‘ì¶•**í•˜ì—¬ ìƒˆë¡œìš´ íŠ¹ì§• ì§€ë„ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì…ë‹ˆë‹¤.



### 2. CNNì˜ í•µì‹¬ ë ˆì´ì–´ë“¤

* **MaxPooling2D(pool_size=2):** ê°€ë¡œì„¸ë¡œ  ì˜ì—­ì—ì„œ ê°€ì¥ í° ê°’ í•˜ë‚˜ë§Œ ë½‘ì•„ë‚´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
* **ì´ìœ :** íŠ¹ì§•ì˜ ìœ„ì¹˜ê°€ ì¡°ê¸ˆ ë³€í•´ë„ ë¬´ê´€í•˜ê²Œ ë§Œë“¤ê³ (ë¶ˆë³€ì„±), ë°ì´í„° í¬ê¸°ë¥¼ ì¤„ì—¬ ì—°ì‚° íš¨ìœ¨ì„ ë†’ì…ë‹ˆë‹¤.


* **Padding (íŒ¨ë”©):** ì´ë¯¸ì§€ í…Œë‘ë¦¬ì— 0ì„ ë‘˜ëŸ¬ì‹¸ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.
* ì¤‘ìš”í•œ ì •ë³´ê°€ í…Œë‘ë¦¬ì— ìˆì„ ë•Œ ì—°ì‚° ê³¼ì •ì—ì„œ ì†Œì‹¤ë˜ëŠ” ê²ƒì„ ë§‰ê³ , ì¶œë ¥ ì‚¬ì´ì¦ˆê°€ ë„ˆë¬´ ë¹¨ë¦¬ ì‘ì•„ì§€ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.



### 3. CNNì˜ í‘œì¤€ íë¦„: Conv â†’ ReLU â†’ Pool â†’ FC

ì´ ìˆœì„œëŠ” ì •ë³´ë¥¼ **'ì¶”ì¶œ-ì •ì œ-ì••ì¶•-íŒë‹¨'**í•˜ëŠ” ë…¼ë¦¬ì  íë¦„ì…ë‹ˆë‹¤.

1. **Conv:** ì´ë¯¸ì§€ì—ì„œ íŠ¹ì§• ì¶”ì¶œ.
2. **ReLU:** ì˜ë¯¸ ì—†ëŠ” ìŒìˆ˜ ë°ì´í„°ëŠ” ë²„ë¦¬ê³  ìœ ì˜ë¯¸í•œ ì–‘ìˆ˜ë§Œ í†µê³¼(ë¹„ì„ í˜•ì„± ì¶”ê°€).
3. **Pool:** ì¤‘ìš”í•œ íŠ¹ì§•ë§Œ ë‚¨ê¸°ê³  ë°ì´í„° í¬ê¸° ì••ì¶•(ìš”ì•½).
4. **FC(Fully Connected):** ìš”ì•½ëœ íŠ¹ì§•ë“¤ì„ ëª¨ì•„ ìµœì¢…ì ìœ¼ë¡œ "ì´ê±´ ê³ ì–‘ì´ë‹¤"ë¼ê³  íŒë‹¨.

---

## ğŸ›  íŠ¸ëŸ¬ë¸” ìŠˆíŒ…: ê¹Šì´ ìˆëŠ” ê³ ë¯¼ í•´ê²°

### Q1. ì°¨ì› ì¶•ì†Œì™€ í’€ë§ì€ 'ë°ì´í„° ì˜¤ì—¼' ì•„ë‹Œê°€ìš”? ì •í™•ë„ê°€ ë–¨ì–´ì§ˆ í…ë°...

**A:** ì•„ì£¼ ì˜ˆë¦¬í•œ ì§€ì ì…ë‹ˆë‹¤! ì—„ë°€íˆ ë§í•˜ë©´ ì •ë³´ì˜ **'ì†ì‹¤'**ì€ ë§ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë¥¼ **'ì¶”ì¶œ'**ì´ë¼ê³  ë¶€ë¥´ëŠ” ì´ìœ ê°€ ìˆìŠµë‹ˆë‹¤.

* ì´ë¯¸ì§€ì—ëŠ” 'ë…¸ì´ì¦ˆ(ë¶ˆí•„ìš”í•œ ë°°ê²½ ë“±)'ê°€ ì•„ì£¼ ë§ìŠµë‹ˆë‹¤. ëª¨ë“  í”½ì…€ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ê°€ë©´ ëª¨ë¸ì€ ë³¸ì§ˆì ì¸ í˜•ì²´ê°€ ì•„ë‹ˆë¼ ë…¸ì´ì¦ˆê¹Œì§€ ë‹¤ ì™¸ì›Œë²„ë¦½ë‹ˆë‹¤(ê³¼ì í•©).
* **í•µì‹¬:** ì •ë³´ì˜ ì–‘ì€ ì¤„ì–´ë“¤ì§€ë§Œ, **ì •ë³´ì˜ ë°€ë„(ë³¸ì§ˆ)**ëŠ” ë†’ì•„ì§‘ë‹ˆë‹¤. ì „ì²´ ì •í™•ë„ë¥¼ ì¡°ê¸ˆ í¬ìƒí•˜ë”ë¼ë„ ìƒˆë¡œìš´ ë°ì´í„°ì— ëŒ€í•œ **ë²”ìš©ì„±(Generalization)**ì„ í™•ë³´í•˜ê¸° ìœ„í•œ íŠ¸ë ˆì´ë“œì˜¤í”„(Trade-off)ì…ë‹ˆë‹¤.

### Q2. ì™œ í•„í„° ìˆ˜ëŠ” í•­ìƒ 2ë°°ì”©() ëŠ˜ì–´ë‚˜ë‚˜ìš”?

**A:** ë‘ ê°€ì§€ ì¸¡ë©´ì˜ ì´ìœ ê°€ ìˆìŠµë‹ˆë‹¤.

1. **ê³µê°„ê³¼ ì±„ë„ì˜ ê· í˜•:** ë’¤ë¡œ ê°ˆìˆ˜ë¡ Poolingì— ì˜í•´ ì´ë¯¸ì§€ì˜ í•´ìƒë„(ê³µê°„ ì •ë³´)ëŠ” ì ˆë°˜ì”© ì¤„ì–´ë“­ë‹ˆë‹¤. ì´ë•Œ ì‚¬ë¼ì§€ëŠ” ê³µê°„ ì •ë³´ë¥¼ ë³´ìƒí•˜ê¸° ìœ„í•´ íŠ¹ì§•(ì±„ë„)ì˜ ê°€ì§“ìˆ˜ë¥¼ ëŠ˜ë ¤ ì •ë³´ì˜ ì „ì²´ ìš©ëŸ‰ì„ ìœ ì§€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
2. **ì»´í“¨íŒ… íš¨ìœ¨:** ì»´í“¨í„°(GPU)ëŠ”  ë‹¨ìœ„ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œ ê°€ì¥ ë¹ ë¦…ë‹ˆë‹¤. (ë©”ëª¨ë¦¬ ì •ë ¬ ë°©ì‹ ë•Œë¬¸)

### Q3. Train/Validation ë¹„êµ vs Train/Test ë¹„êµ, ì°¨ì´ê°€ ë­”ê°€ìš”?

**A:** ì‹œí—˜ì— ë¹„ìœ í•˜ë©´ ëª…í™•í•©ë‹ˆë‹¤.

* **Train Set:** ì—°ìŠµë¬¸ì œ (ì´ê±¸ë¡œ ê³µë¶€í•¨).
* **Validation Set:** **ëª¨ì˜ê³ ì‚¬ (ê³µë¶€í•˜ëŠ” ë„ì¤‘ì— ë‚´ ì‹¤ë ¥ì„ ì ê²€í•˜ê³  í•™ìŠµ ë°©ì‹(ì—í¬í¬ ë“±)ì„ ìˆ˜ì •í•¨).**
* **Test Set:** ìˆ˜ëŠ¥ ì‹œí—˜ (ê³µë¶€ê°€ ë‹¤ ëë‚œ í›„ ë‹¨ í•œ ë²ˆë§Œ ë³´ëŠ” ìµœì¢… ì„±ì í‘œ).

> ë§Œì•½ í•™ìŠµ ì¤‘ì— Test Setì„ ë³´ê³  ì—í¬í¬ë¥¼ ì¡°ì •í•˜ë©´, ëª¨ë¸ì€ ì´ë¯¸ ìˆ˜ëŠ¥ ë¬¸ì œë¥¼ ë³¸ ì…ˆì´ ë˜ì–´ë²„ë¦½ë‹ˆë‹¤. ì´ë¥¼ **'ë°ì´í„° ëˆ„ìˆ˜(Data Leakage)'**ë¼ê³  í•˜ë©°, ì‹¤ì œ ì„œë¹„ìŠ¤ì— ë°°í¬í–ˆì„ ë•Œ ì„±ëŠ¥ì´ ì²˜ì°¸í•´ì§€ëŠ” ì›ì¸ì´ ë©ë‹ˆë‹¤.

---

## ğŸ’» CNN ì½”ë“œ ì‹¤ìŠµ (Keras ì˜ˆì‹œ)

```python
from tensorflow.keras import layers, models

model = models.Sequential()

# 1. Conv + Pool: íŠ¹ì§• ì¶”ì¶œ ë‹¨ê³„
# í•„í„° 32ê°œ, í•„í„° í¬ê¸° (3,3), íŒ¨ë”© ì‚¬ìš©
model.add(layers.Conv2D(32, (3, 3), padding='same', activation='relu', input_shape=(28, 28, 1)))
model.add(layers.MaxPooling2D((2, 2))) # ì‚¬ì´ì¦ˆ ì ˆë°˜ ì¶•ì†Œ

# 2. ë” ê¹Šì€ íŠ¹ì§• ì¶”ì¶œ (í•„í„° ìˆ˜ ì¦ê°€)
model.add(layers.Conv2D(64, (3, 3), padding='same', activation='relu'))
model.add(layers.MaxPooling2D((2, 2)))

# 3. ë¶„ë¥˜ ë‹¨ê³„ (FC)
model.add(layers.Flatten()) # 2D íŠ¹ì§• ì§€ë„ë¥¼ 1Dë¡œ í´ì¤Œ
model.add(layers.Dense(64, activation='relu'))
model.add(layers.Dense(10, activation='softmax')) # 10ê°œ í´ë˜ìŠ¤ ë¶„ë¥˜

model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

# í•™ìŠµ ì‹œ validation_dataë¥¼ ë„£ì–´ ì‹¤ì‹œê°„ìœ¼ë¡œ ê³¼ì í•© ëª¨ë‹ˆí„°ë§
# history = model.fit(train_images, train_labels, epochs=10, 
#                     validation_data=(val_images, val_labels))

```
