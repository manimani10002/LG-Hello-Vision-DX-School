# 📅 21일차 TIL: 오류의 통제와 최적의 모델 찾기

## 1. 가설 검정과 오류의 영역

통계적으로 $H_0$(귀무가설)과 $H_1$(대립가설)의 분포가 겹치는 구간은 모델이 판단을 헷갈려 하는 **'불확실성의 영역'** 입니다.

* **1종 오류 (Type I Error, $\alpha$):** 실제로는 $H_0$인데 $H_1$이라고 잘못 판정하는 영역.
* **2종 오류 (Type II Error, $\beta$):** 실제로는 $H_1$인데 $H_0$이라고 잘못 판정하는 영역.

---

## 2. 임계점(Threshold)의 이동과 트레이드오프

임계점을 움직이면 한쪽 오류는 줄어들지만, 반드시 다른 쪽 오류가 늘어납니다.

* **문제점:** 1종 오류가 무서워서 임계점을 한쪽 끝으로 밀어버리면, 오류는 안 나겠지만 모든 데이터를 한쪽으로만 분류하게 되어 모델의 **분별력(Discriminative Power)** 이 상실됩니다.
* **해결책 (F1-Score):** 정밀도와 재현율의 균형점인 **F1-Score** 가 최대가 되는 지점을 찾거나, **ROC-AUC**를 통해 전체적인 분별력을 확인합니다.

```python
from sklearn.metrics import precision_recall_curve
import numpy as np

# 모델이 계산한 1일 확률 (예시)
pred_probs = model.predict_proba(X_test)[:, 1]

# 임계값 변화에 따른 정밀도, 재현율 계산
precisions, recalls, thresholds = precision_recall_curve(y_test, pred_probs)

# F1-Score가 최대인 지점의 임계값 찾기
f1_scores = 2 * (precisions * recalls) / (precisions + recalls)
best_idx = np.argmax(f1_scores)
best_threshold = thresholds[best_idx]

print(f"최적의 임계값: {best_threshold}")

```

---

## 3. 근본적인 해결: "교집합이 적은 모델 만들기"

질문하신 **"어떻게 하면 $H_0$와 $H_1$의 교집합을 줄일 것인가"** 는 모델의 성능을 근본적으로 올리는 방법입니다.

### ① 변수 선택과 특징 공학 (Feature Engineering)

* **원리:** 두 집단을 더 잘 설명할 수 있는 새로운 칼럼($X$)을 찾는 것입니다.
* **예시:** 키만 가지고 성별을 분류하면 교집합이 크지만, '머리카락 길이'나 '골격 데이터'를 추가하면 두 집단의 분포가 점점 멀어집니다.

### ② 더 복잡하고 유연한 모델 사용

* 데이터가 비선형적일 때 단순한 선형 모델을 쓰면 분포가 겹쳐 보입니다. 이때 **Decision Tree, Random Forest, Deep Learning** 같은 복잡한 모델을 쓰면 데이터 사이의 경계를 더 세밀하게 찾아내어 교집합을 줄일 수 있습니다.

### ③ 데이터 스케일링 및 정규화

* 데이터의 범위를 맞추어 모델이 변수 간의 관계를 더 명확히 파악하게 돕습니다.

```python
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier

# 1. 데이터 스케일링 (분포를 명확하게)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_train)

# 2. 강력한 알고리즘 사용 (분별력 강화)
model = RandomForestClassifier(n_estimators=100)
model.fit(X_scaled, y_train)

```

---

## 4. 모델 성능의 시각화: ROC 곡선

교집합이 얼마나 적은지를 한눈에 보여주는 지표가 바로 **ROC 곡선** 입니다.

* 두 분포가 완전히 갈라질수록 곡선은 왼쪽 위 구석으로 붙습니다.
* 이 아래 면적을 **AUC(Area Under Curve)** 라고 하며, 1에 가까울수록 "교집합이 없는 최고의 모델"입니다.
